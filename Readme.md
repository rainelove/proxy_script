#### proxy.sh 代理脚本

----
作者：张彬\
部门：许继电气股份有限公司保护自动化系统公司\
联系方式：xjbh_zhangbin@163.com

---
##### 一、简介
proxy.sh 是一个简单的配置网络代理的脚本，为了便于配置变电站II区数据网关机的代理业务。

在有些地区的变电站中，如冀北电网，为了节约并方便管理IP地址，为站内的多个业务通道，如故障录波、保护信息子站等只分配一个IP地址，通过端口号使多个业务复用同一个IP地址，也就是所谓的NAT代理技术。这项技术在发明之初就是为了解决逐渐枯竭的IPV4地址问题。

##### 二、使用方法

将 proxy.sh 脚本文件以及 proxy.conf 配置文件传入II区数据网关机的 `/usrdsk/CSU8000/update` 文件夹内，在系统自启动脚本中增加下面一行。

```[bash]
bash proxy.sh
```

修改配置文件 proxy.conf，示例配置文件格式如下：

```
[扩建故障录波]
tcp,172.17.70.71:102,18.101.11.140:60011    ;500kV第一二串故障录波器A套_61850业务_一平面
tcp,172.17.70.72:102,18.101.11.140:60012    ;500kV第一二串故障录波器B套_61850业务_一平面
tcp,172.17.70.73:102,18.101.11.140:60013    ;2号主变故障录波器A套_61850业务_一平面
tcp,172.17.70.74:102,18.101.11.140:60014    ;2号主变故障录波器B套_61850业务_一平面
tcp,172.17.70.75:102,18.101.11.140:60015    ;2号主变SVG故障录波器B套_61850业务_一平面
```

为了便于维护，可以将不同类型的业务分组，并在每组配置的头部使用`[]中括号`备注组名。每一行对应一个业务配置，其中`;分号`后面是该行配置的备注。每一行配置的键值由`,逗号`隔开，从左至右依次为代理协议类型，外部IP地址及端口号，内部IP地址及端口号。